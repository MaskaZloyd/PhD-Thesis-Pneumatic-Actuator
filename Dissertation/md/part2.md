# СОСТАВЛЕНИЕ МАТЕМАТИЧЕСКОЙ МОДЕЛИ ПНЕВМОПРИВОДА {#ch:ch2}

Данная глава посвящена математическому моделированию ПП с дискретными
распределителями. Рассматриваются следующие ключевые аспекты:

1.  Структура и принцип работы исследуемого ПП;

2.  Моделирование пневмоцилиндра;

3.  Моделирование дискретных распределителей;

4.  Моделирование силы трения и упругих деформаций;

5.  Адаптация математической модели к эффективному численному расчету на
    ЭВМ.

6.  Верификация математической модели.

Математическая модель включает:

1.  Уравнения движения поршня;

2.  Уравнения изменения давления в полостях цилиндра;

3.  Уравнения изменения температуры рабочего тела в полостях цилиндра;

4.  Модель массового расхода воздуха;

5.  Модель динамики распределителей;

6.  Модель сил трения;

7.  Модель силы реакции опоры.

Используются уравнения термодинамики и газовой динамики. Учитываются
нелинейные эффекты: сжимаемость воздуха, особенности течения через
дросселирующие элементы, силы трения и реакции опоры.

Верификация модели проводится путем проверки математической
корректности.

## Структура и принцип работы исследуемого пневмопривода {#sec:ch2/sec1}

Исследуемый электропневматический привод включает пневматический цилиндр
двустороннего действия c односторонним штоком и четыре двухпозиционных
распределителя. Цилиндр содержит две рабочие полости, разделенные
поршнем.

Ключевой особенностью привода является конфигурация распределителей. К
каждой полости цилиндра подключены два независимых распределителя: один
для подачи сжатого воздуха из магистрали, другой для выхлопа в
атмосферу. Такая конфигурация обеспечивает гибкое управление потоками
воздуха в обеих полостях цилиндра.

<figure id="fig:ch2/pneumatic_actuator_scheme">

<figcaption>Принципиальная пневматическая схема исследуемого
привода</figcaption>
</figure>

Каждый распределитель имеет два дискретных состояния: открыто и закрыто.
Общее количество возможных комбинаций состояний распределителей
определяется формулой: $$N = 2^k,$$ где $N$ - число комбинаций, $k$ -
количество распределителей.

Для рассматриваемой системы с четырьмя распределителями:
$$N = 2^4 = 16.$$

Таким образом, система имеет 16 дискретных состояний, что обеспечивает
широкие возможности управления при сохранении относительной простоты
конструкции.

Система управления генерирует дискретные сигналы для активации
электромагнитных клапанов распределителей. Обратная связь по положению
реализуется посредством датчика линейного перемещения на штоке цилиндра.

Использование дискретных распределителей вместо пропорциональных, как
было сказано ранее, снижает стоимость системы, однако требует разработки
более сложных алгоритмов управления для компенсации нелинейного
характера коммутации пневматических линий.

## Моделирование пневмоцилиндра {#sec:ch2/sec2}

При разработке математической модели пневмоцилиндра были приняты
следующие основные допущения:

1.  Рабочим телом является идеальный газ (воздух), подчиняющийся
    уравнению состояния Клапейрона-Менделеева;

2.  Процессы в рабочих полостях пневмоцилиндра рассматриваются как
    адиабатические, теплообмен с окружающей средой не учитывается;

3.  Температура газа в магистрали и температура окружающей среды
    принимаются постоянными;

4.  Утечки газа через уплотнения поршня и штока не учитываются;

5.  Давление в выхлопной магистрали принимается равным атмосферному;

6.  Влияние сил тяжести на движение поршня не учитывается ввиду
    горизонтального расположения пневмоцилиндра;

7.  Пневматические линии между распределителями и рабочими полостями
    цилиндра считаются короткими, их объем пренебрежимо мал по сравнению
    с объемом рабочих полостей;

8.  Эффекты сжимаемости воздуха в трубопроводах не учитываются.

С учетом принятых допущений, математическая модель пневмоцилиндра может
быть представлена системой дифференциальных уравнений, описывающих
изменение давлений в рабочих полостях, температур газа и движение
поршня. Данная система уравнений формирует основу для дальнейшего
анализа динамики пневмопривода и синтеза алгоритмов управления.

### Уравнение движения пневмоцилиндра {#sec:ch2/sec2/subsec1}

Рассмотрим пневмоцилиндр как систему с одной степень свободы. Обобщенной
координатой выберем положение поршня $x$. Для применения принципа
Гамильтона необходимо составить функцию Лагранжа: $$
    L = T - U,$$ где $T$ -- кинетическая энергия системы; $U$ --
потенциальная энергия системы; $L$ -- функция Лагранжа.

Кинетическую энергию системы можно представить в виде: $$
    T = \frac{M}{2} \dot{x}^2,$$ где $M$ -- масса подвижных частей
системы; $\dot{x}$ -- скорость движения поршня.

Потенциальная энергия системы включает в себя работу силы давления газа
в рабочих полостях цилиндра:

$$
    U = p_1 V_1 + p_2 V_2 + p_\text{атм} (V_1 - V_2),$$ где $p_1$ и
$p_2$ -- давления в рабочих полостях цилиндра; $V_1$ и $V_2$ -- объемы
рабочих полостей; $p_\text{атм}$ -- атмосферное давление.

Объемы рабочих полостей связаны с положением поршня следующим образом:
$$
    \begin{aligned}
        V_1 & = F_1 (x - x_0),     \\
        V_2 & = F_2 (L - x + x_0),
    \end{aligned}$$ где $F_1=\pi D_{поршня}^2/4$ и
$F_2 = \pi (D_{поршня}^2/4 - D_{штока}^2/4)$ -- активные площади
поперечного сечения поршня в поршневой и штоковой полостях
соответственно; $x_0$ -- начальное положение поршня; $L$ -- ход поршня.

Подставляя [\[eq:ch2/eq1\]](#eq:ch2/eq1){reference-type="eqref"
reference="eq:ch2/eq1"},
[\[eq:ch2/eq2\]](#eq:ch2/eq2){reference-type="eqref"
reference="eq:ch2/eq2"} и
[\[eq:ch2/eq3\]](#eq:ch2/eq3){reference-type="eqref"
reference="eq:ch2/eq3"} в
[\[eq:ch2/eq0\]](#eq:ch2/eq0){reference-type="eqref"
reference="eq:ch2/eq0"}, получим функцию Лагранжа:

$$
    \begin{aligned}
        L & = \frac{M}{2} \dot{x}^2 - p_1 F_1 (x - x_0) - p_2 F_2 (L - x + x_0) \\
          & - p_\text{атм} (F_1 (x - x_0) - F_2 (L - x + x_0)).
    \end{aligned}$$

Обобщенную силу $Q_x$, действующую на систему учитывающую силу трения и
реакции упоров, можно представить в виде: $$
    Q_x = - R_{\text{тр}} - R_{\text{упор}},$$ где $R_{\text{тр}}$ --
сила трения; $R_{\text{упор}}$ -- сила реакции упора.

Запишем уравнение лагранжа в общем виде:

$$
    \frac{d}{dt} \left( \frac{\partial L}{\partial \dot{x}} \right) - \frac{\partial L}{\partial x} = Q_x.$$

Вычислим частные производные функции Лагранжа
[\[eq:ch2/eq4\]](#eq:ch2/eq4){reference-type="eqref"
reference="eq:ch2/eq4"} по обобщенной координате $x$ и ее производной
$\dot{x}$:

$$
    \begin{aligned}
        \frac{\partial L}{\partial \dot{x}} & = M \dot{x},                                    \\
        \frac{\partial L}{\partial x}       & = p_1 F_1 - p_2 F_2 - p_\text{атм} (F_1 - F_2).
    \end{aligned}$$

Подставляя [\[eq:ch2/eq7\]](#eq:ch2/eq7){reference-type="eqref"
reference="eq:ch2/eq7"} и
[\[eq:ch2/eq5\]](#eq:ch2/eq5){reference-type="eqref"
reference="eq:ch2/eq5"} в
[\[eq:ch2/eq6\]](#eq:ch2/eq6){reference-type="eqref"
reference="eq:ch2/eq6"}, получим уравнение движения пневмоцилиндра:

$$
    M \ddot{x} = p_1 F_1 - p_2 F_2 - p_\text{атм} (F_1 - F_2) - R_{\text{тр}} - R_{\text{упор}}.$$
где $\ddot{x}$ -- ускорение поршня.

### Уравнения изменения давлений в полостях пневмоцилиндра {#sec:ch2/sec2/subsec2}

Первоначально получим дифференциальные уравнения изменения давлений в
полостях пневмоцилиндра, основываясь на началах термодинамики и
уравнения Максвелла с учетом ранее принятых допущений. Ключевыми
допущениями для данного вывода являются: рассмотрение воздуха как
идеального газа, адиабатический характер процессов в полостях цилиндра,
отсутствие утечек газа через уплотнения, и пренебрежение объемом
пневматических линий между распределителями и рабочими полостями.

Согласно первому началу термодинамики для открытой системы, изменение
внутренней энергии рабочего тела описывается уравнением:

$$
    dU = \partial Q - \partial W + hdm,$$

где $dU$ - изменение внутренней энергии; $\partial Q$ -- подведенное
тепло; $\partial W$ -- совершенная работа; $h$ -- удельная энтальпия;
$dm$ -- изменение массы системы.

Учитывая, что процесс рассматривается как адиабатический, то
$\partial Q = 0$ и работа совершается только за счет изменения объема
газа в полостях цилиндра: $$
    \partial W = -pdV.$$

Тогда уравнение изменения внутренней энергии примет вид: $$
    dU = -pdV + hdm.$$

Используя определение энтальпии $H - U = pV$, получим: $$
    d(H-pV) = -pdV + hdm.$$

Раскрывая дифференциалы, получим: $$
    dH - pdV - Vdp = -pdV + hdm.$$

Сокращая слагаемые, получим уравнение изменения энтальпии: $$
    dH = Vdp + hdm.$$

Обратимся к соотношению Максвелла для энтальпии, которое связывает
изменение энтальпии с изменением давления и температуры: $$
    dH = \left(
    \frac{\partial H}{\partial p}
    \right)_T dp + \left(
    \frac{\partial H}{\partial T}
    \right)_p dT.$$

Приравнивая правые части уравнений
[\[eq:ch2/enthalpy_change\]](#eq:ch2/enthalpy_change){reference-type="eqref"
reference="eq:ch2/enthalpy_change"} и
[\[eq:ch2/maxwell_enthalpy\]](#eq:ch2/maxwell_enthalpy){reference-type="eqref"
reference="eq:ch2/maxwell_enthalpy"}, получаем:

$$
    \left(
    \frac{\partial H}{\partial p}
    \right)_T dp + \left(
    \frac{\partial H}{\partial T}
    \right)_p dT = Vdp + hdm.$$

Воспользуемся одним из соотношений Максвелла: $$
    \left(
    \frac{\partial H}{\partial p}
    \right)_T = V - T \left(
    \frac{\partial V}{\partial T}
    \right)_p.$$

Подставляя это выражение в
[\[eq:ch2/enthalpy_equality\]](#eq:ch2/enthalpy_equality){reference-type="eqref"
reference="eq:ch2/enthalpy_equality"}, получим: $$
    \left( V - T \left(
        \frac{\partial V}{\partial T}
        \right)_p \right) dp + \left(
    \frac{\partial H}{\partial T}
    \right)_p dT = Vdp + hdm.$$

После упрощения и группировки членов, приходим к следующему выражению:
$$
    -T \left(
    \frac{\partial V}{\partial T}
    \right)_p dp + \left(
    \frac{\partial H}{\partial T}
    \right)_p dT = hdm.$$

Используем еще одно важное термодинамическое соотношение: $$
    \left(
    \frac{\partial H}{\partial T}
    \right)_p = c_p,$$ где $c_p$ -- удельная теплоемкость при постоянном
давлении.

Подставляя
[\[eq:ch2/specific_heat\]](#eq:ch2/specific_heat){reference-type="eqref"
reference="eq:ch2/specific_heat"} в уравнение
[\[eq:ch2/enthalpy_simplified\]](#eq:ch2/enthalpy_simplified){reference-type="eqref"
reference="eq:ch2/enthalpy_simplified"}, получим: $$
    -T \left(
    \frac{\partial V}{\partial T}
    \right)_p dp + c_p dT = hdm.$$

Для идеального газа справедливо соотношение: $$
    \left(\frac{\partial V}{\partial T}\right)_p = \frac{R}{p},$$ где
$R$ -- газовая постоянная.

Используя данное выражение, преобразуем уравнение: $$
    -\frac{RT}{p} dp + c_p dT = h dm.$$

Разделив обе части на $dt$ и учитывая, что $dm/dt = G$ (массовый
расход), получаем дифференциальное уравнение: $$
    -\frac{RT}{p} \frac{dp}{dt} + c_p \frac{dT}{dt} = hG.$$

Теперь обратимся к уравнению состояния идеального газа: $$
    pV = mRT.$$

Дифференцируя его по времени, получаем: $$
    V\frac{dp}{dt} + p\frac{dV}{dt} = RT\frac{dm}{dt} + mR\frac{dT}{dt}.$$

Подставляя выражение для $dT/dt$ из уравнения
[\[eq:ch2/differential_equation\]](#eq:ch2/differential_equation){reference-type="eqref"
reference="eq:ch2/differential_equation"} и учитывая, что для идеального
газа $$
    c_p - c_v = R,$$ где $c_v$ -- удельная теплоемкость при постоянном
объеме, после ряда алгебраических преобразований получаем: $$
    \frac{dp}{dt} = \frac{\gamma}{V}\left(RT\frac{dm}{dt} - p\frac{dV}{dt}\right),$$
где $\gamma = c_p/c_v$ -- показатель адиабаты.

Учитывая, что к каждой полости пневмоцилиндра подключены два независимых
распределителя: один для подачи сжатого воздуха из магистрали, другой
для выхлопа в атмосферу, запишем уравнение
[\[eq:ch2/pressure_change\]](#eq:ch2/pressure_change){reference-type="eqref"
reference="eq:ch2/pressure_change"} для обеих полостей:

$$
    \begin{cases}
        \begin{aligned}
            \frac{dp_1}{dt} & = \frac{\gamma}{V_1}\left(RT_1\frac{dm_1}{dt} - p_1\frac{dV_1}{dt}\right), \\
            \frac{dp_2}{dt} & = \frac{\gamma}{V_2}\left(RT_2\frac{dm_2}{dt} - p_2\frac{dV_2}{dt}\right),
        \end{aligned}
    \end{cases}$$ где индексы 1 и 2 соответствуют левой и правой
полостям пневмоцилиндра.

Изменение массы газа в каждой полости определяется суммарным массовым
расходом через оба распределителя, подключенных к этой полости: $$
    \begin{cases}
        \begin{aligned}
            \frac{dm_1}{dt} & = G_{1\text{вх}} - G_{1\text{вых}}, \\
            \frac{dm_2}{dt} & = G_{2\text{вх}} - G_{2\text{вых}},
        \end{aligned}
    \end{cases}$$ где $G_{1\text{вх}}$ и $G_{2\text{вх}}$ -- массовые
расходы воздуха, поступающего в полости через впускные распределители;
$G_{1\text{вых}}$ и $G_{2\text{вых}}$ -- массовые расходы воздуха,
выходящего из полостей через выпускные распределители.

Изменение объемов полостей связано с движением поршня: $$
    \frac{dV_1}{dt} = F_1\frac{dx}{dt}, \quad \frac{dV_2}{dt} = -F_2\frac{dx}{dt},$$
где $F_1$ и $F_2$ -- эффективные площади поршня в левой и правой
полостях соответственно.

Таким образом, окончательная система уравнений, описывающая изменение
давлений в полостях пневмоцилиндра с учетом конфигурации
распределителей, принимает вид: $$
    \begin{cases}
        \begin{aligned}
            \frac{dp_1}{dt} & = \frac{\gamma}{V_1}\left(RT_1(G_{1\text{вх}} - G_{1\text{вых}}) - p_1 F_1\frac{dx}{dt}\right), \\
            \frac{dp_2}{dt} & = \frac{\gamma}{V_2}\left(RT_2(G_{2\text{вх}} - G_{2\text{вых}}) + p_2 F_2\frac{dx}{dt}\right).
        \end{aligned}
    \end{cases}$$

Система уравнений
[\[eq:ch2/final_pressure_system\]](#eq:ch2/final_pressure_system){reference-type="eqref"
reference="eq:ch2/final_pressure_system"} полностью описывает изменение
давлений в полостях пневмоцилиндра с учетом массообмена через
распределители и изменения объемов полостей при движении поршня.

### Уравнения энергетического баланса {#sec:ch2/sec2/subsec3}

Начнем с уравнения первого начала термодинамики для открытой системы,
представленного в выражении
[\[eq:ch2/first_law\]](#eq:ch2/first_law){reference-type="eqref"
reference="eq:ch2/first_law"}. Учитывая принятые допущения об
адиабатическом характере процесса и работе, совершаемой только за счет
изменения объема, получаем: $$
    dU = -pdV + hdm.$$

Для идеального газа внутренняя энергия определяется как $U = mC_vT$.
Дифференцируя это выражение и приравнивая к уравнению
[\[eq:ch2/energy_balance_1\]](#eq:ch2/energy_balance_1){reference-type="eqref"
reference="eq:ch2/energy_balance_1"}, получаем: $$
    C_vTdm + mC_vdT = -pdV + hdm.$$

Используя определение энтальпии для идеального газа $h = C_pT$ и
соотношение $C_p - C_v = R$, преобразуем уравнение
[\[eq:ch2/energy_balance_2\]](#eq:ch2/energy_balance_2){reference-type="eqref"
reference="eq:ch2/energy_balance_2"}: $$
    mC_vdT = -pdV + RTdm.$$

Разделив обе части уравнения
[\[eq:ch2/energy_balance_3\]](#eq:ch2/energy_balance_3){reference-type="eqref"
reference="eq:ch2/energy_balance_3"} на $dt$ и учитывая, что $dm/dt$
представляет собой массовый расход $G$, получаем дифференциальное
уравнение: $$
    mC_v\frac{dT}{dt} = -p\frac{dV}{dt} + RTG.$$

Далее воспользуемся уравнением состояния идеального газа
[\[eq:ch2/ideal_gas_equation\]](#eq:ch2/ideal_gas_equation){reference-type="eqref"
reference="eq:ch2/ideal_gas_equation"}. Дифференцируя его по времени и
комбинируя с уравнением
[\[eq:ch2/energy_balance_4\]](#eq:ch2/energy_balance_4){reference-type="eqref"
reference="eq:ch2/energy_balance_4"}, после алгебраических
преобразований приходим к выражению: $$
    \frac{dT}{dt} = \frac{T}{p}\frac{dp}{dt} + \frac{(\gamma-1)T}{V}\frac{dV}{dt},$$
где $\gamma = C_p/C_v$ - показатель адиабаты, определенный ранее.

Учитывая конфигурацию распределителей, описанную в системе уравнений
[\[eq:ch2/pressure_system\]](#eq:ch2/pressure_system){reference-type="eqref"
reference="eq:ch2/pressure_system"}, запишем уравнения изменения
температур для обеих полостей пневмоцилиндра: $$
    \begin{cases}
        \begin{aligned}
            \frac{dT_1}{dt} & = \frac{T_1}{p_1}\frac{dp_1}{dt} + \frac{(\gamma-1)T_1}{V_1}\frac{dV_1}{dt}, \\
            \frac{dT_2}{dt} & = \frac{T_2}{p_2}\frac{dp_2}{dt} + \frac{(\gamma-1)T_2}{V_2}\frac{dV_2}{dt}.
        \end{aligned}
    \end{cases}$$

Подставляя выражения для $dp_1/dt$ и $dp_2/dt$ из системы
[\[eq:ch2/final_pressure_system\]](#eq:ch2/final_pressure_system){reference-type="eqref"
reference="eq:ch2/final_pressure_system"}, а также учитывая изменение
объемов полостей, связанное с движением поршня, как описано в уравнениях
[\[eq:ch2/volume_change\]](#eq:ch2/volume_change){reference-type="eqref"
reference="eq:ch2/volume_change"}, получаем окончательную систему
уравнений, описывающую изменение температур в полостях пневмоцилиндра:

$$
    \begin{cases}
        \begin{aligned}
            \frac{dT_1}{dt} & = \frac{\gamma-1}{m_1C_v}\left[RT_1(G_{1\text{вх}} - G_{1\text{вых}}) - p_1F_1\frac{dx}{dt}\right], \\
            \frac{dT_2}{dt} & = \frac{\gamma-1}{m_2C_v}\left[RT_2(G_{2\text{вх}} - G_{2\text{вых}}) + p_2F_2\frac{dx}{dt}\right].
        \end{aligned}
    \end{cases}$$

Данная система уравнений
[\[eq:ch2/energy_balance_final\]](#eq:ch2/energy_balance_final){reference-type="eqref"
reference="eq:ch2/energy_balance_final"} полностью согласуется с ранее
выведенными уравнениями изменения давлений и описывает термодинамические
процессы в пневмоприводе с дискретными распределителями, учитывая
массообмен через распределители и работу, совершаемую при движении
поршня.

## Моделирование силы трения {#sec:ch2/sec2/subsec4}

В рамках математического моделирования электропневматического привода
существенное значение имеет адекватное описание динамических эффектов
трения, оказывающих значительное влияние на точность позиционирования и
качество переходных процессов. Модель LuGre (Lund-Grenoble) представляет
собой комплексный подход к моделированию трения, основанный на
представлении микроскопической природы контактного взаимодействия
поверхностей через концепцию щетиночной структуры.

Фундаментальное уравнение модели LuGre описывает эволюцию средней
деформации микронеровностей контактирующих поверхностей во времени и
может быть представлено в виде дифференциального уравнения первого
порядка: $$
\frac{dz}{dt} = v - \frac{\sigma_0|v|}{g(v)}z,$$ где $z$ -- средняя
деформация микронеровностей; $v$ -- относительная скорость скольжения;
$\sigma_0$ -- представляет собой коэффициент жесткости микроскопических
деформаций.

Функция $g(v)$, известная как функция Штрибека, описывает характер
установившегося трения и задается следующим выражением:

$$
g(v) = R_\text{к} + (R_\text{с} - R_\text{к})e^{-(|v|/v_s)^\delta},$$
где $R_\text{к}$ -- сила кулоновского трения; $R_\text{с}$ -- определяет
силу статического трения; $v_s$ -- характерная скорость Штрибека;
$\delta$ -- эмпирический параметр формы, для которого типичным значением
считается $\delta = 2$.

Результирующая сила трения в модели LuGre формируется как суперпозиция
трех составляющих: $$
R_\text{тр} = \sigma_0z + \sigma_1\dot{z} + \sigma_2v,$$ где $\sigma_1$
-- демпфирование микродеформаций; $\sigma_2$ -- коэффициент вязкого
трения.

Параметры модели LuGre обладают четкой физической интерпретацией, что
существенно облегчает процесс их идентификации. Коэффициент $\sigma_0$
характеризует жесткость контактного взаимодействия микронеровностей и
определяется как предел отношения приращения силы трения к приращению
деформации при стремлении последней к нулю: $$    
\sigma_0 = \lim_{z \to 0} \frac{\partial R_\text{тр}}{\partial z},$$

Параметр микродемпфирования $\sigma_1$ связан с коэффициентом жесткости
через коэффициент микродемпфирования $\eta$:
$$\sigma_1 = \eta\sigma_0.$$

Коэффициент вязкого трения $\sigma_2$ определяет асимптотическое
поведение силы трения при больших скоростях движения:
$$\lim_{v \to \infty} \frac{R_\text{тр}}{v} = \sigma_2.$$

В контексте электропневматического привода модель LuGre позволяет учесть
ряд важных эффектов. При малых перемещениях поршня наблюдается эффект
предварительного смещения (эффект Дала), описываемый соотношением
$R_\text{пред} = \sigma_0z$ при условии $|z| < z_\text{макс}$. В области
малых скоростей проявляется нелинейная зависимость силы трения от
скорости: $R_\text{нел}(v) = g(v)\text{sign}(v) + \sigma_2v$. При
реверсивном движении наблюдается гистерезисное поведение с характерной
величиной $\Delta R_\text{гист} = 2R_\text{с}$ при $v = 0$.

Применение модели LuGre в математическом описании электропневматического
привода обеспечивает существенное повышение точности моделирования
динамических процессов, особенно в режимах малых перемещений и при
реверсивном движении, что имеет критическое значение для решения задач
прецизионного позиционирования. Учет динамических эффектов трения
позволяет более точно прогнозировать поведение системы и разрабатывать
эффективные алгоритмы управления с учетом реальных физических процессов
в зоне контакта движущихся элементов привода.

## Моделирование силы реакции опоры {#sec:ch2/sec2/subsec5}

В контексте математического моделирования электропневматического привода
существенную роль играет адекватное описание силы реакции опоры. Данная
сила возникает при контакте поршня пневмоцилиндра с ограничителями хода
и оказывает значительное влияние на динамику системы, особенно в крайних
положениях.

Сила реакции опоры $R_\text{оп}$ может быть представлена как функция
положения поршня $x$ и его скорости $\dot{x}$:
$$R_\text{оп} = f(x, \dot{x}).$$

При этом необходимо учитывать, что данная сила проявляется только при
достижении поршнем крайних положений. Таким образом, модель силы реакции
опоры должна включать условия её активации.

Наиболее распространенным подходом к моделированию силы реакции опоры
является использование кусочно-линейной модели с учетом жесткости и
демпфирования. Данная модель может быть описана следующим образом: $$
    R_\text{оп} = \begin{cases}
        k_\text{оп}(x - x_\text{мин}) + b_\text{оп}\dot{x},  & \text{если } x < x_\text{мин}                       \\
        0,                                                   & \text{если } x_\text{мин} \leq x \leq x_\text{макс} \\
        k_\text{оп}(x - x_\text{макс}) + b_\text{оп}\dot{x}, & \text{если } x > x_\text{макс}
    \end{cases}$$

## Моделирование дискретных распределителей {#sec:ch2/sec3}

### Уравнения массового расхода рабочего тела {#sec:ch2/sec3/subsec1}

Массовый расход воздуха через дискретный распределитель является
ключевым параметром, определяющим динамику пневматической системы. Для
его описания используется модель, основанная на уравнении
Сен-Венана-Ванцеля:
$$G = \psi(p_1, p_2) \cdot C_d F_\text{пр} \frac{p_1}{\sqrt{RT_\text{вх}}},$$
где $\psi(p_1, p_2)$ -- расходная функция; $C_d$ -- коэффициент расхода;
$F_\text{пр}$ -- эффективная площадь проходного сечения; $p_1$ --
давление на входе; $p_2$ -- давление на выходе; $T_\text{вх}$ --
температура воздуха на входе.

Ключевым элементом в данном уравнении является расходная функция
$\psi(p_1, p_2)$, которая учитывает влияние отношения давлений на входе
и выходе распределителя на массовый расход. Эта функция определяется
следующим образом: $$\psi(p_1, p_2) = \begin{cases}
        \sqrt{\frac{2\gamma}{\gamma-1}\left[\left(\frac{p_2}{p_1}\right)^{\frac{2}{\gamma}} - \left(\frac{p_2}{p_1}\right)^{\frac{\gamma+1}{\gamma}}\right]}, & \text{если } \frac{p_2}{p_1} > b_{кр}    \\
        \sqrt{\gamma \left(\frac{2}{\gamma+1}\right)^{\frac{\gamma+1}{\gamma-1}}},                                                                            & \text{если } \frac{p_2}{p_1} \leq b_{кр}
    \end{cases}$$ где
$b_{кр} = \left(\frac{2}{\gamma+1}\right)^{\frac{\gamma}{\gamma-1}}$ --
критическое отношение давлений.

Для наглядного представления характера изменения расходной функции
$\psi(p_1, p_2)$ в зависимости от отношения давлений $p_2/p_1$ приведен
график представлены на рисунке
[1.2](#fig:ch2/mass_flow_function){reference-type="ref"
reference="fig:ch2/mass_flow_function"}.

<figure id="fig:ch2/mass_flow_function">

<figcaption>График расходной функции <span
class="math inline"><em>ψ</em>(<em>p</em><sub>1</sub>, <em>p</em><sub>2</sub>)</span></figcaption>
</figure>

На графике отчетливо видны две области: докритическое и закритическое
течение, разделенные точкой критического отношения давлений $b_{кр}$.

В области докритического течения ($p_2/p_1 > b_{кр}$) расход зависит от
отношения давлений и описывается нелинейной функцией. Здесь наблюдается
плавное увеличение расхода с уменьшением отношения давлений.

В закритической области ($p_2/p_1 \leq b_{кр}$) расход достигает
максимального значения и остается постоянным независимо от дальнейшего
снижения отношения давлений. Это явление связано с достижением скорости
потока воздуха в самом узком сечении распределителя скорости звука.

Критическая точка $b_{кр}$ соответствует условию, при котором скорость
потока воздуха в самом узком сечении распределителя достигает скорости
звука. Для воздуха при нормальных условиях значение $b_{кр}$ составляет
приблизительно 0.528. Эффективная площадь проходного сечения
$F_\text{др}$ зависит от положения запорно-регулирующего элемента
распределителя и может быть представлена как функция управляющего
сигнала $u$: $$F_\text{др} = F_{max} \cdot f(u),$$ где
$F_{max} = F_\text{пр}$ -- максимальная эффективная площадь проходного
сечения; $f(u)$ -- функция, описывающая зависимость площади от
управляющего сигнала.

В данной работе используется линейная зависимость площади проходного
сечения от управляющего сигнала. $$f(u) = F_{max} \cdot u.$$

Тогда уравнение массового расхода принимает вид: $$
    G = \psi(p_1, p_2) \cdot C_d F_{max} \cdot u \frac{p_1}{\sqrt{RT_\text{вх}}}.$$

Представленная модель массового расхода позволяет точно описать процесс
истечения воздуха через дискретный распределитель в различных режимах
работы пневмопривода. Учет нелинейного характера расходной функции и
влияния критического отношения давлений особенно важен при анализе
динамики системы и разработке алгоритмов управления, обеспечивающих
высокую точность и быстродействие электропневматического привода.

### Динамика переключения распределителей {#sec:ch2/sec3/subsec2}

Процесс переключения дискретного распределителя характеризуется
определенной динамикой, которую необходимо учитывать для точного
моделирования поведения системы. Динамика переключения может быть
описана дифференциальным уравнением первого порядка: $$
    \tau \frac{du}{dt} + u = u_{зад},$$ где: $u$ -- текущее положение
запорно-регулирующего элемента; $u_{зад}$ -- заданное положение (0 или 1
для дискретного распределителя); $\tau$ -- постоянная времени
переключения.

Учет динамики переключения позволяет моделировать такие эффекты, как
задержка срабатывания и дребезг контактов, которые могут оказывать
существенное влияние на поведение системы, особенно при высокочастотном
управлении.

Интеграция моделей массового расхода и динамики переключения в общую
математическую модель электропневматического привода осуществляется
путем их включения в уравнения изменения давлений в полостях
пневмоцилиндра
[\[eq:ch2/pressure_system\]](#eq:ch2/pressure_system){reference-type="ref"
reference="eq:ch2/pressure_system"}.

В данной работе использована модель первого порядка для описания
динамики переключения поскольку она обеспечивает достаточно точное
описание процесса переключения и имеет простую структуру.

## Адаптация математической модели к эффективному численному расчету на ЭВМ {#sec:ch2/sec5}

Эффективное численное моделирование динамики электропневматического
привода требует оптимизации математической модели для выполнения
расчетов на ЭВМ. Данный этап критически важен для обеспечения высокой
производительности вычислений при проведении многочисленных итераций в
задачах оптимизации, анализа чувствительности и робастности системы
управления.

Основные цели оптимизации математической модели включают:

1.  Снижение вычислительной сложности уравнений;

2.  Уменьшение времени выполнения расчетов;

3.  Повышение численной устойчивости алгоритмов;

4.  Эффективное использование параллельных вычислительных архитектур.

Для достижения этих целей будут применены следующие методы:

1.  Векторизация уравнений;

2.  Упрощение и линеаризация нелинейных выражений;

3.  Предварительное вычисление констант и коэффициентов;

### Векторизация уравнений {#sec:ch2/sec5/subsec1}

Векторизация уравнений представляет собой эффективный метод оптимизации
вычислений, позволяющий использовать преимущества SIMD-инструкций
(Single Instruction, Multiple Data) современных процессоров. Данный
подход особенно актуален для математической модели
электропневматического привода с дискретными распределителями, где
многие операции могут быть выполнены параллельно
[-@eichenberger2004simd] над несколькими элементами данных.

Основная идея векторизации заключается в преобразовании скалярных
операций в векторные, что позволяет обрабатывать несколько элементов
данных одновременно [-@nuzman2011vaporsimd]. В контексте рассматриваемой
модели это означает переход от поэлементных вычислений к операциям над
векторами и матрицами. Процесс векторизации начинается с представления
состояния системы в виде единого вектора. Для электропневматического
привода вектор состояния может быть записан как:

$$
    \mathbf{y} = [x, v, p_1, p_2, T_1, T_2, u_1, u_2, u_3, u_4]^T.$$

Векторизованная форма уравнения движения поршня
[\[eq:ch2/eq8\]](#eq:ch2/eq8){reference-type="eqref"
reference="eq:ch2/eq8"} может быть представлена следующим образом:

$$
    M\ddot{x} = \mathbf{F}^T\mathbf{p} - p_\text{атм}(\mathbf{F}^T\mathbf{1}) - R_\text{тр}(\dot{x}) - R_\text{оп}(x, \dot{x}),$$
где $\mathbf{F} = [F_1, -F_2]^T$ -- вектор эффективных площадей поршня;
$\mathbf{p} = [p_1, p_2]^T$ -- вектор давлений в полостях цилиндра;
$\mathbf{1} = [1, 1]^T$ - единичный вектор.

Уравнения изменения давлений в полостях
[\[eq:ch2/final_pressure_system\]](#eq:ch2/final_pressure_system){reference-type="eqref"
reference="eq:ch2/final_pressure_system"} могут быть векторизованы
следующим образом: $$
    \dot{\mathbf{p}} = \frac{\gamma}{\mathbf{V}(\mathbf{x})} \odot (R\mathbf{T} \odot \mathbf{G} - \mathbf{p} \odot (\mathbf{F}\dot{x})),$$
где $\odot$ обозначает поэлементное умножение векторов;
$\mathbf{T} = [T_1, T_2]^T$ -- вектор температур в полостях;
$\mathbf{G} = [G_1, G_2]^T$ -- вектор суммарных массовых расходов для
каждой полости; $\mathbf{V}(\mathbf{x}) = [V_1(x), V_2(x)]^T$ --
вектор-функция объемов полостей.

Уравнения изменения температур
[\[eq:ch2/energy_balance_final\]](#eq:ch2/energy_balance_final){reference-type="eqref"
reference="eq:ch2/energy_balance_final"} также могут быть представлены в
векторной форме: $$
    \dot{\mathbf{T}} = \frac{\gamma-1}{\mathbf{m}C_v} \odot (R\mathbf{T} \odot \mathbf{G} \pm \mathbf{p} \odot (\mathbf{F}\dot{x})),$$
где $\mathbf{m} = [m_1, m_2]^T$ -- вектор масс воздуха в полостях.

Динамика переключения распределителей
[\[eq:ch2/switching_dynamics\]](#eq:ch2/switching_dynamics){reference-type="eqref"
reference="eq:ch2/switching_dynamics"} может быть векторизована для всех
четырех распределителей одновременно: $$
    \tau \dot{\mathbf{u}} + \mathbf{u} = \mathbf{u}_\text{зад},$$ где
$\mathbf{u} = [u_1, u_2, u_3, u_4]^T$ -- вектор текущих положений
запорно-регулирующих элементов распределителей; $\mathbf{u}_\text{зад}$
-- вектор заданных положений.

Для расчета массовых расходов через распределители можно использовать
векторизованную форму уравнения массового расхода: $$
    \mathbf{G} = \psi(\mathbf{p}_\text{вх}, \mathbf{p}_\text{вых}) \odot \mathbf{C}_d \odot \mathbf{F}_\text{пр} \odot \mathbf{u} \odot \frac{\mathbf{p}_\text{вх}}{\sqrt{R\mathbf{T}_\text{вх}}},$$
где $\psi(\mathbf{p}_\text{вх}, \mathbf{p}_\text{вых})$ --
векторизованная расходная функция; $\mathbf{C}_d$ и
$\mathbf{F}_\text{пр}$ -- векторы коэффициентов расхода и эффективных
площадей проходных сечений распределителей соответственно.

Применение векторизации позволяет эффективно использовать
SIMD-инструкции процессора, что приводит к значительному ускорению
вычислений. В зависимости от архитектуры процессора и специфики
реализации, ускорение может достигать 2-4 раза [-@tian2013simd] по
сравнению с исходной скалярной версией.

### Оптимизация нелинейных функций {#sec:ch2/sec5/subsec2}

Так же важным этапом оптимизации является упрощение и линеаризация
нелинейных функций, которые могут оказывать существенное влияние на
вычислительную сложность модели и деаль ее жесткой. В контексте
электропневматического привода, к нелинейным функцям относятся
экспоненциальная функция в модели трения, функция sign, реакция упоров и
условные операции.

Для оптимизации вычисления экспоненциальной функции в модели трения
предлагается использовать аппроксимацию Паде. Данный метод обеспечивает
высокую точность аппроксимации при сравнительно низкой вычислительной
сложности. Аппроксимация Паде для экспоненциальной функции может быть
представлена в виде:

$$e^x \approx \frac{1 + \frac{x}{2} + \frac{x^2}{10} + \frac{x^3}{120}}{1 - \frac{x}{2} + \frac{x^2}{10} - \frac{x^3}{120}}.$$

Данная аппроксимация обеспечивает высокую точность в диапазоне
$x \in [-2,5; 2,5]$, что достаточно для моделирования эффекта Штрибека в
рассматриваемой системе.

Реакция упоров, обычно моделируемая с использованием условных операций,
может быть оптимизирована применением непрерывной аппроксимации:

$$R_\text{оп} = k_\text{оп}(x - x_\text{мин})\cdot S(x - x_\text{мин}) + k_\text{оп}(x - x_\text{макс})\cdot S(x - x_\text{макс}),$$
где $S(x)$ -- сглаживающая функция, например:

$$S(x) = \frac{1}{1 + e^{-\alpha x}},$$ где $\alpha$ -- параметр,
определяющий крутизну перехода.

Для оптимизации условных операций в модели предлагается использовать
непрерывные аппроксимации. Например, функция максимума может быть
аппроксимирована как:

$$\max(a, b) \approx \frac{a + b + \sqrt{(a - b)^2 + \varepsilon}}{2},$$
где $\varepsilon$ -- малое положительное число, обеспечивающее гладкость
функции.

Применяя предложенные оптимизации, уравнения реакции упоров и силы
трения могут быть представлены в виде:

$$\begin{alignedat}{2}
        g(v) & = \left[R_\text{к} + (R_\text{с} - R_\text{к})\frac{1 + \frac{z}{2} + \frac{z^2}{10} + \frac{z^3}{120}}{1 - \frac{z}{2} + \frac{z^2}{10} - \frac{z^3}{120}}\right] \\
        R_\text{оп} & = k_\text{оп}(x - x_\text{мин})\cdot \frac{1}{1 + e^{-\alpha(x - x_\text{мин})}} + k_\text{оп}(x - x_\text{макс})\cdot \frac{1}{1 + e^{-\alpha(x - x_\text{макс})}},
    \end{alignedat}$$

### Аналитическое вычисление якобиана для численного решения ОДУ {#sec:ch2/sec5/subsec3}

В контексте оптимизации математической модели пневматического привода
была реализована процедура аналитического вычисления матрицы Якоби для
повышения эффективности численного интегрирования. Данный подход
позволяет существенно снизить вычислительные затраты и повысить
численную стабильность решения системы дифференциальных уравнений.

Якобиан системы определяется как матрица частных производных:

$$
    J = \frac{\partial \mathbf{f}}{\partial \mathbf{y}} =
    \begin{pmatrix}
        \frac{\partial f_1}{\partial y_1}    & \frac{\partial f_1}{\partial y_2}    & \cdots & \frac{\partial f_1}{\partial y_{10}}    \\
        \frac{\partial f_2}{\partial y_1}    & \frac{\partial f_2}{\partial y_2}    & \cdots & \frac{\partial f_2}{\partial y_{10}}    \\
        \vdots                               & \vdots                               & \ddots & \vdots                                  \\
        \frac{\partial f_{10}}{\partial y_1} & \frac{\partial f_{10}}{\partial y_2} & \cdots & \frac{\partial f_{10}}{\partial y_{10}}
    \end{pmatrix}$$

где $\mathbf{f}$ -- вектор-функция правых частей системы
дифференциальных уравнений.

Рассмотрим вычисление элементов матрицы Якоби для каждого уравнения
системы:

##### Уравнение движения поршня

Для уравнения движения поршня $\dot{x} = v$ имеем: $$
    \begin{aligned}
        \frac{\partial \dot{x}}{\partial x}   & = 0                          \\
        \frac{\partial \dot{x}}{\partial v}   & = 1                          \\
        \frac{\partial \dot{x}}{\partial y_i} & = 0, \quad i = 3, \ldots, 10
    \end{aligned}$$

##### Уравнение ускорения поршня

Для уравнения ускорения поршня: $$
    \begin{aligned}
        \frac{\partial \dot{v}}{\partial x}   & = -\frac{1}{M}\left(\frac{\partial R_\text{тр}}{\partial x} + \frac{\partial R_\text{оп}}{\partial x}\right) \\
        \frac{\partial \dot{v}}{\partial v}   & = -\frac{1}{M}\left(\frac{\partial R_\text{тр}}{\partial v} + \frac{\partial R_\text{оп}}{\partial v}\right) \\
        \frac{\partial \dot{v}}{\partial p_1} & = \frac{F_1}{M}                                                                                              \\
        \frac{\partial \dot{v}}{\partial p_2} & = -\frac{F_2}{M}                                                                                             \\
        \frac{\partial \dot{v}}{\partial y_i} & = 0, \quad i = 5, \ldots, 10
    \end{aligned}$$ где частные производные силы трения и реакции опоры
вычисляются на основе их моделей
[\[eq:ch2/friction_force\]](#eq:ch2/friction_force){reference-type="eqref"
reference="eq:ch2/friction_force"} и
[\[eq:ch2/support_reaction\]](#eq:ch2/support_reaction){reference-type="eqref"
reference="eq:ch2/support_reaction"} соответственно.

##### Уравнения изменения давлений

Для уравнений изменения давлений в полостях цилиндра: $$
    \begin{aligned}
        \frac{\partial \dot{p_i}}{\partial x}   & = -\frac{\gamma p_i}{V_i^2}\frac{\partial V_i}{\partial x}(RT_iG_i - p_iF_iv) + \frac{\gamma}{V_i}\left(RT_i\frac{\partial G_i}{\partial x} - F_iv\frac{\partial p_i}{\partial x} - p_iF_i\frac{\partial v}{\partial x}\right) \\
        \frac{\partial \dot{p_i}}{\partial v}   & = \frac{\gamma}{V_i}\left(RT_i\frac{\partial G_i}{\partial v} - p_iF_i\right)                                                                                                                                                  \\
        \frac{\partial \dot{p_i}}{\partial p_i} & = \frac{\gamma}{V_i}\left(RT_i\frac{\partial G_i}{\partial p_i} - F_iv\right)                                                                                                                                                  \\
        \frac{\partial \dot{p_i}}{\partial T_i} & = \frac{\gamma}{V_i}\left(RG_i + RT_i\frac{\partial G_i}{\partial T_i}\right)                                                                                                                                                  \\
        \frac{\partial \dot{p_i}}{\partial u_j} & = \frac{\gamma RT_i}{V_i}\frac{\partial G_i}{\partial u_j}, \quad j = 1, \ldots, 4
    \end{aligned}$$ где $i = 1, 2$ для левой и правой полостей
соответственно.

##### Уравнения изменения температур

Аналогично для уравнений изменения температур: $$
    \begin{aligned}
        \frac{\partial \dot{T_i}}{\partial x}   & = \frac{\gamma-1}{m_iC_v}\left(R\frac{\partial (T_iG_i)}{\partial x} \pm \frac{\partial (p_iF_iv)}{\partial x}\right) \\
        \frac{\partial \dot{T_i}}{\partial v}   & = \frac{\gamma-1}{m_iC_v}\left(R\frac{\partial (T_iG_i)}{\partial v} \pm p_iF_i\right)                                \\
        \frac{\partial \dot{T_i}}{\partial p_i} & = \frac{\gamma-1}{m_iC_v}\left(R\frac{\partial (T_iG_i)}{\partial p_i} \pm F_iv\right)                                \\
        \frac{\partial \dot{T_i}}{\partial T_i} & = \frac{\gamma-1}{m_iC_v}\left(RG_i + RT_i\frac{\partial G_i}{\partial T_i}\right)                                    \\
        \frac{\partial \dot{T_i}}{\partial u_j} & = \frac{(\gamma-1)RT_i}{m_iC_v}\frac{\partial G_i}{\partial u_j}, \quad j = 1, \ldots, 4
    \end{aligned}$$

##### Уравнения динамики переключения распределителей

Для уравнений динамики переключения распределителей: $$
    \begin{aligned}
        \frac{\partial \dot{u_i}}{\partial u_i} & = -\frac{1}{\tau}     \\
        \frac{\partial \dot{u_i}}{\partial y_j} & = 0, \quad j \neq i+6
    \end{aligned}$$ где $i = 1, \ldots, 4$ для каждого распределителя.

Для вычисления частных производных массового расхода
$\partial G_i/\partial y_j$ необходимо учитывать нелинейную зависимость
расходной функции $\psi(p_1, p_2)$ от давлений.

Рассмотрим производные расходной функции по давлениям: $$
    \begin{alignedat}{6}
        \frac{\partial \psi}{\partial p_1} & = \begin{cases}
                                                   -\frac{1}{p_1}\frac{\gamma+1}{\gamma-1}\left(\frac{p_2}{p_1}\right)^{\frac{2}{\gamma}}\left[1 - \left(\frac{p_2}{p_1}\right)^{\frac{\gamma-1}{\gamma}}\right]\frac{1}{\psi}, & \text{если } \frac{p_2}{p_1} > b_\text{кр}    \\
                                                   0,                                                                                                                                                                           & \text{если } \frac{p_2}{p_1} \leq b_\text{кр} \\
                                               \end{cases} \\
        \frac{\partial \psi}{\partial p_2} & = \begin{cases}
                                                   \frac{1}{p_2}\frac{\gamma+1}{\gamma-1}\left(\frac{p_2}{p_1}\right)^{\frac{2}{\gamma}-1}\left[1 - \left(\frac{p_2}{p_1}\right)\right]\frac{1}{\psi}, & \text{если } \frac{p_2}{p_1} > b_\text{кр}    \\
                                                   0,                                                                                                                                                  & \text{если } \frac{p_2}{p_1} \leq b_\text{кр}
                                               \end{cases}
    \end{alignedat}$$

Теперь, используя эти производные, можно вычислить частные производные
массового расхода по переменным состояния системы. Для примера
рассмотрим производную массового расхода по давлению в первой полости
цилиндра: $$
    \frac{\partial G_1}{\partial p_1} = C_d F_\text{пр} u_1 \left(\frac{\partial \psi}{\partial p_1} \cdot \frac{p_1}{\sqrt{RT_1}} + \psi \cdot \frac{1}{\sqrt{RT_1}}\right)$$

Аналогичным образом вычисляются производные по другим переменным
состояния. Для производных по температуре и положениям
запорно-регулирующих элементов распределителей имеем: $$
    \begin{aligned}
        \frac{\partial G_1}{\partial T_1} & = -\frac{1}{2} C_d F_\text{пр} u_1 \psi \frac{p_1}{\sqrt{RT_1^3}} \\
        \frac{\partial G_1}{\partial u_1} & = C_d F_\text{пр} \psi \frac{p_1}{\sqrt{RT_1}}
    \end{aligned}$$

Полная матрица Якоби формируется путем объединения всех вычисленных
частных производных в соответствии с их позициями в векторе состояния
системы
[\[eq:ch2/state_vector\]](#eq:ch2/state_vector){reference-type="eqref"
reference="eq:ch2/state_vector"}.

Применение якобиана для в методах численных численного интегрирования,
таких как BDF (Backward Differentiation Formula) и Radau, позволяет
уменьшить количество вычислений и повысить численную стабильность. В
частности, использование якобиана позволяет уменьшить количество
вычислений правых частей системы, что особенно важно для жестких систем.

## Реализация математической модели {#sec:ch2/sec6}

Сведем полученные выражения в единую систему:

$$\begin{cases}
        \begin{alignedat}{2}
            \dot{x}               & = v                                                                                                                                                                                                   \\
            M\dot{v}              & = \mathbf{F}^T\mathbf{p} - p_\text{атм}(\mathbf{F}^T\mathbf{1}) - R_\text{тр}(v) - R_\text{оп}(x, v)                                                                                                  \\
            \dot{\mathbf{p}}      & = \frac{\gamma}{\mathbf{V}(\mathbf{x})} \odot (R\mathbf{T} \odot \mathbf{G} - \mathbf{p} \odot (\mathbf{F}v))                                                                                         \\
            \dot{\mathbf{T}}      & = \frac{\gamma-1}{\mathbf{m}C_v} \odot (R\mathbf{T} \odot \mathbf{G} \pm \mathbf{p} \odot (\mathbf{F}v))                                                                                              \\
            \mathbf{u}_\text{зад} & = \tau \dot{\mathbf{u}} + \mathbf{u}                                                                                                                                                                  \\
            \mathbf{G}            & = \psi(\mathbf{p}_\text{вх}, \mathbf{p}_\text{вых}) \odot \mathbf{C}_d \odot \mathbf{F}_\text{пр} \odot \mathbf{u} \odot \frac{\mathbf{p}_\text{вх}}{\sqrt{R\mathbf{T}_\text{вх}}}                    \\
            R_\text{тр} &= \sigma_0 z + \sigma_1 \dot{z} + \sigma_2 v                                                                                                                              \\
            \dot{z} &= v - \frac{\sigma_0 |v|}{g(v)}z \\
            R_\text{оп}           & = k_\text{оп}(x - x_\text{мин})\cdot \frac{1}{1 + e^{-\alpha(x - x_\text{мин})}} + k_\text{оп}(x - x_\text{макс})\cdot \frac{1}{1 + e^{-\alpha(x - x_\text{макс})}}                                   \\
        \end{alignedat}
    \end{cases}$$

Представим данную систему в виде функциональной блок-схемы,
представленной на рисунке
[1.3](#fig:ch2/block_diagram){reference-type="ref"
reference="fig:ch2/block_diagram"}.

<figure id="fig:ch2/block_diagram">

<figcaption>Функциональная блок-схема математической модели
электропневматического привода</figcaption>
</figure>

В процессе исследования осуществлена программная реализация
математической модели пневматического привода с применением
объектно-ориентированного подхода. При разработке программного комплекса
использован язык программирования Python, обеспечивающий необходимую
функциональность для численного моделирования и обработки результатов.
Архитектура программного комплекса базируется на принципах модульности и
инкапсуляции, что обеспечивает высокую степень гибкости при модификации
отдельных компонентов системы.

Центральным элементом реализации является класс `PneumaticCylinder`,
инкапсулирующий математическую модель пневматического привода. В данном
классе реализована система дифференциальных уравнений, описывающих
динамику привода, включая уравнения движения поршня, термодинамические
процессы в рабочих полостях и динамику переключения распределителей.
Математическая модель дополнена отдельными классами для описания
нелинейных эффектов: `FrictionModel` -- для моделирования сил трения и
`StopForce` -- для учета ограничений хода поршня.

Численное интегрирование системы дифференциальных уравнений
осуществляется с использованием метода BDF (Backward Differentiation
Formula), реализованного в библиотеке `scipy.integrate`. Выбор данного
метода обусловлен жёсткостью исследуемой системы дифференциальных
уравнений. Для повышения эффективности численного интегрирования
реализовано аналитическое вычисление матрицы Якоби, что позволяет
существенно сократить вычислительные затраты и повысить численную
стабильность решения.

Визуализация результатов моделирования реализована с применением
библиотеки Matplotlib, обеспечивающей построение графиков временных
зависимостей основных параметров системы: перемещения и скорости поршня,
давлений и температур в полостях цилиндра, состояний распределителей.
При этом программный комплекс предусматривает возможность экспорта
результатов в различные форматы для последующей обработки и анализа.

Разработанная программная реализация обеспечивает возможность
эффективного проведения вычислительных экспериментов, параметрической
оптимизации и анализа динамических характеристик пневматического
привода. Модульная структура программного комплекса позволяет легко
модифицировать отдельные компоненты системы и интегрировать новые
алгоритмы управления.

## Верификация математической модели {#sec:ch2/sec7}

Верификация математической модели представляет собой неотъемлемый этап
разработки, направленный на подтверждение адекватности и точности
полученного математического описания. Процесс верификации включает в
себя комплекс методов и подходов, позволяющих оценить соответствие
модели реальному объекту в рамках принятых допущений и ограничений.

Основной целью верификации является подтверждение способности модели
корректно отражать физические процессы, происходящие в
электропневматическом приводе, и обеспечивать достоверные результаты при
решении задач анализа и синтеза систем управления. В отсутствие
экспериментальных данных, предварительная верификация базируется на
теоретическом анализе, численном моделировании.

Верификация данных происходила на основе следующих параметров модели,
которые согласованны с характерными параметрами экпериментального стенда
и пердставлены в таблице
[1.1](#tab:ch2/extended_parameters){reference-type="ref"
reference="tab:ch2/extended_parameters"}.

::: {#tab:ch2/extended_parameters}
  **Параметр**                                     **Обозначение**                    **Значение**       **Размерность**
  ---------------------------------- ------------------------------------------- ----------------------- -----------------
  Масса подвижных частей                                 $M$                               6.0           кг
  Ход поршня                                             $L$                               0.3           м
  Диаметр поршня                                    $D_\text{п}$                          0.032          м
  Диаметр штока                                     $d_\text{шт}$                         0.012          м
  Площадь поршня со стороны штока     $F_2 = \pi(D_\text{п}^2-d_\text{шт}^2)/4$   $7.07 \times 10^{-4}$  м$^2$
  Площадь поршня со стороны крышки           $F_1 = \pi D_\text{п}^2/4$           $8.04 \times 10^{-4}$  м$^2$
  Давление питания                                  $p_\text{п}$                     $6 \times 10^5$     Па
  Атмосферное давление                             $p_\text{атм}$                    $1 \times 10^5$     Па
  Газовая постоянная воздуха                             $R$                               287           Дж/(кг$\cdot$К)
  Температура воздуха                              $T_\text{атм}$                          293           К
  Показатель адиабаты                                 $\gamma$                             1.4           \-
  Коэффициент расхода                                   $C_d$                              0.7           \-
  Эффективная площадь клапана                           $A_v$                     $1.2 \times 10^{-6}$   м$^2$
  **Параметры силы трения:**                                                                             
  Сила сухого трения                                    $F_c$                              50            Н
  Сила трения покоя                                     $F_s$                              60            Н
  Коэффициент вязкого трения                         $\sigma_2$                            100           Н$\cdot$с/м
  Скорость Штрибека                                     $v_s$                             0.01           м/с
  Показатель степени Штрибека                         $\delta$                              2            \-
  **Параметры реакции опор:**                                                                            
  Коэффициент жесткости опоры                       $k_\text{оп}$                    $1 \times 10^6$     Н/м
  Коэффициент демпфирования опоры                   $b_\text{оп}$                         1000           Н$\cdot$с/м
  Координата нижнего упора                         $x_\text{мин}$                           0            м
  Координата верхнего упора                        $x_\text{макс}$                         0.3           м

  : Расширенные параметры моделирования электропневматического привода
:::

[]{#tab:ch2/extended_parameters label="tab:ch2/extended_parameters"}

### Теоретические основы верификации {#sec:ch2/sec7/subsec1}

Процесс верификации основывается на следующих ключевых принципах:

1.  Принцип физической непротиворечивости, требующий соответствия модели
    фундаментальным законам механики и пневматики;

2.  Принцип математической корректности, предполагающий отсутствие
    ошибок в формулировке уравнений и их решении;

3.  Принцип консервативности, обеспечивающий выполнение законов
    сохранения массы и энергии в модели;

4.  Принцип устойчивости решения, гарантирующий сходимость численных
    методов при различных начальных условиях и параметрах системы.

Методологический базис верификации включает:

1.  Аналитический анализ структуры модели и ее соответствия физическим
    законам;

2.  Численное моделирование с исследованием сходимости и устойчивости
    решения;

3.  Анализ предельных случаев и упрощенных режимов работы системы;

4.  Оценку чувствительности модели к вариациям параметров.

Математически процесс верификации может быть формализован как задача
минимизации функционала ошибки между результатами моделирования и
теоретическими предсказаниями для известных частных случаев:
$$J = \min_{\theta} \sum_{i=1}^{N} \left| f_{\text{модель}}(x_i, \theta) - f_{\text{теория}}(x_i) \right|^2,$$
где $f_{\text{модель}}$ -- функция, описывающая выход модели;
$f_{\text{теория}}$ -- теоретически предсказанное значение; $x_i$ --
входные параметры; $\theta$ -- параметры модели; $N$ -- количество точек
сравнения.

Выбор методов верификации обусловлен спецификой исследуемой системы и
включает:

1.  Проверку размерностей и единиц измерения всех величин в уравнениях
    модели.

2.  Анализ асимптотического поведения модели при предельных значениях
    параметров.

3.  Исследование сходимости численного решения при измельчении шага
    интегрирования.

4.  Оценку энергетического баланса системы и соблюдения закона
    сохранения массы.

### Проверка маетматической корректности {#sec:ch2/sec7/subsec2}

Проверка математической корректности модели электропневматического
привода с дискретными распределителями осуществляется посредством
следующих процедур:

1.  Анализ размерностей и единиц измерения;

2.  Верификация согласованности уравнений с законами сохранения;

3.  Оценка физической непротиворечивости уравнений;

4.  Анализ непрерывности и дифференцируемости функций.

Каждая процедура направлена на выявление потенциальных ошибок в
математическом описании системы и обеспечение соответствия модели
фундаментальным физическим принципам.

Основные этапы проверки математической корректности модели подробнее:

##### Анализ размерностей и единиц измерения.

Проверка согласованности размерностей всех величин, входящих в уравнения
модели, осуществляется с использованием метода анализа размерностей. Для
каждого уравнения модели выполняется проверка: $$[LHS] = [RHS],$$ где
$[LHS]$ и $[RHS]$ -- размерности левой и правой частей уравнения
соответственно.

##### Верификация согласованности уравнений с законами сохранения.

Проверяется выполнение законов сохранения массы и энергии. Для закона
сохранения массы в пневматической системе:

$$\frac{d}{dt}(m_1 + m_2) = \dot{m}_\text{вх} - \dot{m}_\text{вых},$$

где $m_1$ и $m_2$ -- массы воздуха в первой и второй полостях
пневмоцилиндра соответственно; $\dot{m}_\text{вх}$ -- суммарный массовый
расход воздуха, поступающего в систему $\dot{m}_\text{вых}$ -- суммарный
массовый расход воздуха, выходящего из системы.

Для проверки этого закона необходимо вычислить изменение общей массы
воздуха в системе и сравнить его с интегралом разности входящих и
выходящих массовых расходов:

$$\Delta m_\text{общ} = \int_{t_0}^{t_1} (\dot{m}_\text{вх} - \dot{m}_\text{вых}) dt,$$

Для закона сохранения энергии:
$$\frac{d}{dt}(E_k + E_p + U) = W_{\text{внеш}} - Q$$ где $E_k$ --
кинетическая энергия; $E_p$ -- потенциальная энергия; $U$ -- внутренняя
энергия; $W_{\text{внеш}}$ -- работа внешних сил; $Q$ -- теплота,
переданная системе.

##### Оценка физической непротиворечивости уравнений.

В рамках оценки физической непротиворечивости уравнений проводится
проверка выполнения второго закона термодинамики для адиабатного
процесса, в частности, принципа неубывания энтропии.

Для адиабатной системы изменение энтропии должно удовлетворять
неравенству: $$\Delta S \geq 0$$ где $\Delta S$ -- изменение энтропии
системы.

Проверка неубывания энтропии осуществляется следующим образом:

1.  Вычисление изменения энтропии для каждой полости цилиндра на каждом
    шаге интегрирования:
    $$\Delta S_i = m_i c_v \ln\left(\frac{T_{i,k+1}}{T_{i,k}}\right) + m_i R \ln\left(\frac{V_{i,k+1}}{V_{i,k}}\right),$$
    где $m_i$ -- масса газа в i-й полости; $c_v$ -- удельная
    теплоемкость при постоянном объеме; $T_{i,k}$ и $V_{i,k}$ --
    температура и объем i-й полости на k-м шаге интегрирования.

2.  Расчет производства энтропии за счет необратимых процессов, включая
    трение и дросселирование газа:
    $$\Delta S_{\text{irr}} = \frac{F_{\text{тр}} \Delta x}{T_{\text{ср}}} + \sum_j G_j R \ln\left(\frac{p_{\text{вых},j}}{p_{\text{вх},j}}\right),$$
    где $F_{\text{тр}}$ -- сила трения; $\Delta x$ -- перемещение;
    $T_{\text{ср}}$ -- средняя температура; $G_j$ -- массовый расход
    через j-й распределитель; $p_{\text{вх},j}$ и $p_{\text{вых},j}$ --
    давления на входе и выходе j-го распределителя.

3.  Проверка условия неубывания суммарной энтропии системы:
    $$\Delta S_{\text{total}} = \sum_i \Delta S_i + \Delta S_{\text{irr}} \geq 0.$$

Дополнительно проверяется выполнение уравнения адиабатного процесса для
каждой полости: $$pV^{\gamma} = \text{const}.$$

### Оценка физичности результатов моделирования {#sec:ch2/sec7/subsec4}

##### Проверка размерностей и единиц измерения.

Рассматриваются размерности основных физических величин, используемых в
модели:

-   Длина: $[L] = \text{м}$;

-   Время: $[T] = \text{с}$;

-   Масса: $[M] = \text{кг}$;

-   Сила: $[F] = \text{кг}\cdot\text{м}/\text{с}^2$;

-   Давление: $[P] = \text{кг}/(\text{м}\cdot\text{с}^2)$;

-   Температура: $[\Theta] = \text{К}$.

Анализ размерностей для каждого уравнения системы:

-   Уравнение движения поршня: $[M\cdot L/T^2] = [P\cdot L^2] + [F]$;

-   Уравнение изменения давления: $[P/T] = [M/(L^2\cdot T^2)]$;

-   Уравнение изменения температуры: $[\Theta/T] = [\Theta/T]$;

-   Уравнение массового расхода:
    $[M/T] = [L^2] \cdot [P] / [L/T] = [M/T]$;

-   Уравнение силы трения: $[F] = [F] + [F\cdot T/L] \cdot [L/T] = [F]$;

-   Уравнение реакции опоры: $[F] = [F/L] \cdot [L] = [F]$;

-   Уравнение динамики золотников: $[1] = [1]$.

Проведенный анализ подтверждает согласованность размерностей во всех
уравнениях математической модели. Это свидетельствует о корректности
формулировки модели с точки зрения физических единиц измерения.

##### Верификация согласованности уравнений с законами сохранения.

Исследование энергетического баланса системы и закона сохранения массы
проводились для различных состояний распределителей. В таблице
[1.2](#tab:ch2/valve_states){reference-type="ref"
reference="tab:ch2/valve_states"} представлены состояния
распределителей, для которых проводилась верификация.

::: {#tab:ch2/valve_states}
  № описания    $u_1$   $u_2$   $u_3$   $u_4$   $p_1\text{, Па}$   $p_2\text{, Па}$
  ------------ ------- ------- ------- ------- ------------------ ------------------
  1               1       0       0       1        1 × 10^5^          1 × 10^5^
  2               1       0       0       0        1 × 10^5^          1 × 10^5^
  3               0       0       0       1        5 × 10^5^          1 × 10^5^
  4               0       1       1       0        1 × 10^5^          1 × 10^5^
  5               0       0       1       0        1 × 10^5^          1 × 10^5^
  6               0       1       0       0        1 × 10^5^          5 × 10^5^

  : Состояния распределителей для верификации модели и начальных условий
  давлений
:::

[]{#tab:ch2/valve_states label="tab:ch2/valve_states"}

Исследования проводились для шести режимов работы, каждый из которых
характеризуется уникальной конфигурацией клапанов и соответствующим
воздействием на движение поршня. Режим 1 обеспечивает максимальное
ускорение в положительном направлении посредством одновременной подачи
сжатого воздуха в переднюю полость пневмоцилиндра и сброса воздуха из
задней полости в атмосферу, создавая максимальный перепад давлений. В
режиме 2 реализуется умеренное ускорение в положительном направлении за
счет подачи сжатого воздуха только в переднюю полость при изолированной
задней полости, что приводит к более плавному увеличению давления. Режим
3 предназначен для замедления при движении в положительном направлении:
передняя полость изолируется, а из задней осуществляется выпуск воздуха
в атмосферу, снижая противодействующее давление. Режим 4, являясь
обратным по отношению к первому, обеспечивает максимальное ускорение в
отрицательном направлении путем подачи сжатого воздуха в заднюю полость
и выпуска воздуха из передней. Режим 5 аналогичен второму, но для
противоположного направления движения: сжатый воздух подается только в
заднюю полость при изолированной передней. Режим 6 симметричен третьему
и предназначен для замедления при движении в отрицательном направлении:
задняя полость изолируется, а из передней осуществляется выпуск воздуха.

Графики на рисунке [1.4](#fig:ch2/energy_balance){reference-type="ref"
reference="fig:ch2/energy_balance"} демонстрируют энергетический баланс
системы для режимов 1, 2 и 3, остальные режимы представлены в приложении
к . Как видно из графиков, энергетический баланс системы соблюдается для
всех рассмотренных режимов, что свидетельствует о соблюдении закона
сохранения энергии и массы в модели.

<figure id="fig:ch2/energy_balance">

<figcaption>Энергетический баланс системы при различных состояниях
распределителей</figcaption>
</figure>

В таблице [1.3](#tab:ch2/energy_balance){reference-type="ref"
reference="tab:ch2/energy_balance"} представлены относительная ошибка
энергетического баланса и закона сохранения массы для всех рассмотренных
режимов работы системы.

::: {#tab:ch2/energy_balance}
  № описания    Погрешность энергии, %   Погрешность массы, %
  ------------ ------------------------ ----------------------
  1                     0.0002                  0.3203
  2                     0.0068                  0.9068
  3                     0.0029                  0.4324
  4                     0.0002                  0.2321
  5                     0.0052                  0.8042
  6                     0.0018                  0.3963

  : Относительная погрешность энергетического баланса и закона
  сохранения массы
:::

[]{#tab:ch2/energy_balance label="tab:ch2/energy_balance"}

##### Оценка физической непротиворечивости уравнений.

Рассмотрение соблюдение второго начала термодинамики так же проводилось
для всех режимов работы системы. На рисунке
[1.5](#fig:ch2/thermodynamics_analysis){reference-type="ref"
reference="fig:ch2/thermodynamics_analysis"} представлены результаты
термодинамического анализа процессов в пневмоприводе для режима 2.
Остальные режимы представлены в приложении к .

<figure id="fig:ch2/thermodynamics_analysis">

<figcaption>Комплексный термодинамический анализ процессов в полостях
электропневматического привода с дискретными
распределителями</figcaption>
</figure>

На рисунке [1.5](#fig:ch2/thermodynamics_analysis){reference-type="ref"
reference="fig:ch2/thermodynamics_analysis"} представлены результаты
термодинамического анализа процессов в электропневматическом приводе с
дискретными распределителями. Анализ динамики изменения энтропии
демонстрирует положительную скорость изменения суммарной энтропии
системы $dS_{сумм}/dt$, что подтверждает соблюдение второго начала
термодинамики. Максимальная скорость роста энтропии наблюдается в
начальный момент времени и составляет порядка 20 J K s^−−1^, что
обусловлено интенсивными процессами массообмена при открытии
распределителя в левой полости пневмоцилиндра.

График эволюции полной энтропии отражает монотонный рост суммарной
энтропии системы $S_{сумм}$ с последующим выходом на установившееся
значение около 5 J K^−1^.

Температурно-энтропийная диаграмма иллюстрирует существенное различие
термодинамических процессов в полостях цилиндра. В первой полости
наблюдается немонотонное изменение температуры с максимумом около 380 K,
тогда как во второй полости происходит монотонный рост температуры до
470 K, что обусловлено различными термодинамическими процессам в камерах
пневмоцилиндра.

Диаграмма в координатах давление-объем показывает характер
термодинамических циклов в полостях привода. В первой полости давление
поддерживается практически постоянным на уровне 5 бар, что
свидетельствует о квазистатическом характере процесса. Во второй полости
наблюдается существенное повышение давления при уменьшении объема, что
характерно для процесса сжатия газа с совершением над ним механической
работы.

Представленные результаты термодинамического анализа подтверждают
корректность разработанной математической модели электропневматического
привода с точки зрения соблюдения фундаментальных законов термодинамики
и позволяют детально исследовать характер протекающих в системе
процессов.

### Заключение о достоверности модели {#sec:ch2/sec7/subsec5}

Проведенная верификация математической модели электропневматического
привода подтвердила её адекватность и достоверность. Анализ размерностей
и единиц измерения продемонстрировал корректность математических
формулировок всех уравнений модели. Проверка согласованности с
фундаментальными законами физики показала, что относительная погрешность
соблюдения закона сохранения энергии не превышает 0.007 процентов, а
закона сохранения массы --- 0.91 процентов для всех исследованных
режимов работы. Термодинамический анализ подтвердил соблюдение второго
начала термодинамики, что проявляется в положительной скорости изменения
суммарной энтропии системы с максимальным значением около 20 J K s^−−1^
в начальный момент времени. Анализ температурно-энтропийных и p-v
диаграмм показал физически корректное описание термодинамических
процессов в полостях пневмоцилиндра.

Таким образом, комплексная верификация подтверждает, что разработанная
математическая модель корректно описывает все существенные физические
процессы в электропневматическом приводе с дискретными распределителями
и может быть использована для решения задач анализа и синтеза систем
управления.
