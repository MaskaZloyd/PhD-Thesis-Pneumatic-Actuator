
\section{Моделирование пневмоцилиндра}\label{sec:ch2/sec2}

При разработке математической модели пневмоцилиндра были приняты следующие основные допущения:
\begin{enumerate}
    \item Рабочим телом является идеальный газ (воздух), подчиняющийся уравнению состояния Клапейрона-Менделеева;
    \item Процессы в рабочих полостях пневмоцилиндра рассматриваются как адиабатические, теплообмен с окружающей средой не учитывается;
    \item Температура газа в магистрали и температура окружающей среды принимаются постоянными;
    \item Утечки газа через уплотнения поршня и штока не учитываются;
    \item Давление в выхлопной магистрали принимается равным атмосферному;
    \item Влияние сил тяжести на движение поршня не учитывается ввиду горизонтального расположения пневмоцилиндра;
    \item Пневматические линии между распределителями и рабочими полостями цилиндра считаются короткими,
          их объем пренебрежимо мал по сравнению с объемом рабочих полостей;
    \item Эффекты сжимаемости воздуха в трубопроводах не учитываются.
\end{enumerate}

С учетом принятых допущений, математическая модель пневмоцилиндра может быть представлена системой
дифференциальных уравнений, описывающих изменение давлений в рабочих полостях, температур газа и
движение поршня. Данная система уравнений формирует основу для дальнейшего анализа динамики пневмопривода
и синтеза алгоритмов управления.

\subsection{Уравнение движения пневмоцилиндра}\label{sec:ch2/sec2/subsec1}
Уравнение движения пневмоцилиндра может быть получено на основе второго закона Ньютона путем
рассмотрения баланса сил, действующих на поршень в горизонтальной плоскости. Выведем данное уравнение,
последовательно учитывая все силовые факторы, оказывающие влияние на динамику системы.

На поршень действует сила давления в поршневой полости, определяемая как произведение давления на эффективную площадь:
\begin{equation}
R_1 = p_1F_1,
\end{equation}
где $p_1$ -- давление в поршневой полости, $F_1$ -- эффективная площадь поршня со стороны поршневой полости.

Аналогично определяется сила давления в штоковой полости:
\begin{equation}
R_2 = p_2F_2,
\end{equation}
где $p_2$ -- давление в штоковой полости, $F_2$ -- эффективная площадь поршня со стороны штоковой полости.

Силы, создаваемые атмосферным давлением, действуют на разность площадей поршня:
\begin{equation}
R_\text{атм} = p_\text{атм}(F_1 - F_2),
\end{equation}
где $p_\text{атм}$ -- атмосферное давление.

Движению поршня препятствует сила трения $R_\text{тр}(\dot{x})$, зависящая от скорости движения, а также реакция упоров $R_\text{упор}(x,\dot{x})$, возникающая при достижении крайних положений.

Применяя второй закон Ньютона к поршню массой $M$, получаем уравнение движения:
\begin{equation}
M\ddot{x} = p_1F_1 - p_2F_2 - p_\text{атм}(F_1 - F_2) - R_\text{тр}(\dot{x}) - R_\text{упор}(x,\dot{x}),
\end{equation}
где $x$ -- перемещение поршня; $\dot{x}$ -- скорость поршня; $\ddot{x}$ -- ускорение поршня.

Эффективные площади поршня определяются его геометрическими размерами:
\begin{equation}
F_1 = \frac{\pi D_{\text{п}}^2}{4},
\end{equation}
\begin{equation}
F_2 = \frac{\pi(D_{\text{п}}^2 - d_{\text{шт}}^2)}{4},
\end{equation}
где $D_{\text{п}}$ -- диаметр поршня, $d_{\text{шт}}$ -- диаметр штока.

\subsection{Уравнения изменения давлений в полостях пневмоцилиндра}\label{sec:ch2/sec2/subsec2}

Первоначально получим дифференциальные уравнения изменения давлений в
полостях пневмоцилиндра, основываясь на началах термодинамики
и уравнения Максвелла с учетом ранее принятых допущений.
Ключевыми допущениями для данного вывода являются: рассмотрение
воздуха как идеального газа, адиабатический характер процессов в полостях
цилиндра, отсутствие утечек газа через уплотнения, и пренебрежение объемом
пневматических линий между распределителями и рабочими полостями.

Согласно первому началу термодинамики для открытой системы, изменение внутренней энергии рабочего тела описывается уравнением:

\begin{equation}
\label{eq:ch2/first_law}
    dU = \partial Q - \partial W + hdm,
\end{equation}

где $dU$ - изменение внутренней энергии;
$\partial Q$ -- подведенное тепло;
$\partial W$ -- совершенная работа;
$h$ -- удельная энтальпия;
$dm$ -- изменение массы системы.

Учитывая, что процесс рассматривается как адиабатический,
то $\partial Q = 0$ и работа совершается только за счет изменения объема газа в полостях цилиндра:
\begin{equation}
\label{eq:ch2/work}
    \partial W = -pdV.
\end{equation}

Тогда уравнение изменения внутренней энергии примет вид:
\begin{equation}
\label{eq:ch2/internal_energy_change}
    dU = -pdV + hdm.
\end{equation}

Используя определение энтальпии $H - U = pV$, получим:
\begin{equation}
\label{eq:ch2/enthalpy_definition}
    d(H-pV) = -pdV + hdm.
\end{equation}

Раскрывая дифференциалы, получим:
\begin{equation}
\label{eq:ch2/enthalpy_differential}
    dH - pdV - Vdp = -pdV + hdm.
\end{equation}

Сокращая слагаемые, получим уравнение изменения энтальпии:
\begin{equation}
\label{eq:ch2/enthalpy_change}
    dH = Vdp + hdm.
\end{equation}

Обратимся к соотношению Максвелла для энтальпии, которое связывает изменение
энтальпии с изменением давления и температуры:
\begin{equation}
\label{eq:ch2/maxwell_enthalpy}
    dH = \left(
    \frac{\partial H}{\partial p}
    \right)_T dp + \left(
    \frac{\partial H}{\partial T}
    \right)_p dT.
\end{equation}

Приравнивая правые части уравнений \eqref{eq:ch2/enthalpy_change} и \eqref{eq:ch2/maxwell_enthalpy}, получаем:

\begin{equation}
\label{eq:ch2/enthalpy_equality}
    \left(
    \frac{\partial H}{\partial p}
    \right)_T dp + \left(
    \frac{\partial H}{\partial T}
    \right)_p dT = Vdp + hdm.
\end{equation}

Воспользуемся одним из соотношений Максвелла:
\begin{equation}
\label{eq:ch2/maxwell_relation}
    \left(
    \frac{\partial H}{\partial p}
    \right)_T = V - T \left(
    \frac{\partial V}{\partial T}
    \right)_p.
\end{equation}

Подставляя это выражение в \eqref{eq:ch2/enthalpy_equality}, получим:
\begin{equation}
\label{eq:ch2/enthalpy_substitution}
    \left( V - T \left(
        \frac{\partial V}{\partial T}
        \right)_p \right) dp + \left(
    \frac{\partial H}{\partial T}
    \right)_p dT = Vdp + hdm.
\end{equation}

После упрощения и группировки членов, приходим к следующему выражению:
\begin{equation}
\label{eq:ch2/enthalpy_simplified}
    -T \left(
    \frac{\partial V}{\partial T}
    \right)_p dp + \left(
    \frac{\partial H}{\partial T}
    \right)_p dT = hdm.
\end{equation}

Используем еще одно важное термодинамическое соотношение:
\begin{equation}
\label{eq:ch2/specific_heat}
    \left(
    \frac{\partial H}{\partial T}
    \right)_p = c_p,
\end{equation}
где $c_p$ -- удельная теплоемкость при постоянном давлении.

Подставляя \eqref{eq:ch2/specific_heat} в уравнение \eqref{eq:ch2/enthalpy_simplified}, получим:
\begin{equation}
\label{eq:ch2/enthalpy_final}
    -T \left(
    \frac{\partial V}{\partial T}
    \right)_p dp + c_p dT = hdm.
\end{equation}

Для идеального газа справедливо соотношение:
\begin{equation}
\label{eq:ch2/ideal_gas_relation}
    \left(\frac{\partial V}{\partial T}\right)_p = \frac{R}{p},
\end{equation}
где $R$ -- газовая постоянная.

Используя данное выражение, преобразуем уравнение:
\begin{equation}
\label{eq:ch2/pressure_temp_relation}
    -\frac{RT}{p} dp + c_p dT = h dm.
\end{equation}

Разделив обе части на $dt$ и учитывая, что $dm/dt = G$ (массовый расход), получаем дифференциальное уравнение:
\begin{equation}
\label{eq:ch2/differential_equation}
    -\frac{RT}{p} \frac{dp}{dt} + c_p \frac{dT}{dt} = hG.
\end{equation}

Теперь обратимся к уравнению состояния идеального газа:
\begin{equation}
\label{eq:ch2/ideal_gas_equation}
    pV = mRT.
\end{equation}

Дифференцируя его по времени, получаем:
\begin{equation}
\label{eq:ch2/ideal_gas_differential}
    V\frac{dp}{dt} + p\frac{dV}{dt} = RT\frac{dm}{dt} + mR\frac{dT}{dt}.
\end{equation}

Подставляя выражение для $dT/dt$ из уравнения \eqref{eq:ch2/differential_equation} и учитывая, что для идеального газа
\begin{equation}
\label{eq:ch2/specific_heat_difference}
    c_p - c_v = R,
\end{equation}
где $c_v$ -- удельная теплоемкость при постоянном объеме, после ряда алгебраических преобразований получаем:
\begin{equation}
\label{eq:ch2/pressure_change}
    \frac{dp}{dt} = \frac{\gamma}{V}\left(RT\frac{dm}{dt} - p\frac{dV}{dt}\right),
\end{equation}
где $\gamma = c_p/c_v$ -- показатель адиабаты.

Учитывая, что к каждой полости пневмоцилиндра подключены два независимых распределителя:
один для подачи сжатого воздуха из магистрали, другой для выхлопа в атмосферу,
запишем уравнение \eqref{eq:ch2/pressure_change} для обеих полостей:

\begin{equation}
\label{eq:ch2/pressure_system}
    \begin{cases}
        \begin{aligned}
            \frac{dp_1}{dt} & = \frac{\gamma}{V_1}\left(RT_1\frac{dm_1}{dt} - p_1\frac{dV_1}{dt}\right), \\
            \frac{dp_2}{dt} & = \frac{\gamma}{V_2}\left(RT_2\frac{dm_2}{dt} - p_2\frac{dV_2}{dt}\right),
        \end{aligned}
    \end{cases}
\end{equation}
где индексы 1 и 2 соответствуют левой и правой полостям пневмоцилиндра.

Изменение массы газа в каждой полости определяется суммарным массовым
расходом через оба распределителя, подключенных к этой полости:
\begin{equation}
\label{eq:ch2/mass_change}
    \begin{cases}
        \begin{aligned}
            \frac{dm_1}{dt} & = G_{1\text{вх}} - G_{1\text{вых}}, \\
            \frac{dm_2}{dt} & = G_{2\text{вх}} - G_{2\text{вых}},
        \end{aligned}
    \end{cases}
\end{equation}
где $G_{1\text{вх}}$ и $G_{2\text{вх}}$ -- массовые расходы воздуха, поступающего в полости через впускные распределители;
$G_{1\text{вых}}$ и $G_{2\text{вых}}$ -- массовые расходы воздуха, выходящего из полостей через выпускные распределители.

Изменение объемов полостей связано с движением поршня:
\begin{equation}
\label{eq:ch2/volume_change}
    \frac{dV_1}{dt} = F_1\frac{dx}{dt}, \quad \frac{dV_2}{dt} = -F_2\frac{dx}{dt},
\end{equation}
где $F_1$ и $F_2$ -- эффективные площади поршня в левой и правой полостях соответственно.

Таким образом, окончательная система уравнений, описывающая изменение
давлений в полостях пневмоцилиндра с учетом конфигурации распределителей, принимает вид:
\begin{equation}
\label{eq:ch2/final_pressure_system}
    \begin{cases}
        \begin{aligned}
            \frac{dp_1}{dt} & = \frac{\gamma}{V_1}\left(RT_1(G_{1\text{вх}} - G_{1\text{вых}}) - p_1 F_1\frac{dx}{dt}\right), \\
            \frac{dp_2}{dt} & = \frac{\gamma}{V_2}\left(RT_2(G_{2\text{вх}} - G_{2\text{вых}}) + p_2 F_2\frac{dx}{dt}\right).
        \end{aligned}
    \end{cases}
\end{equation}

Система уравнений \eqref{eq:ch2/final_pressure_system} полностью описывает
изменение давлений в полостях пневмоцилиндра с учетом массообмена через
распределители и изменения объемов полостей при движении поршня.

\subsection{Уравнения энергетического баланса}\label{sec:ch2/sec2/subsec3}

Начнем с уравнения первого начала термодинамики для открытой системы, представленного в выражении \eqref{eq:ch2/first_law}. Учитывая принятые допущения об адиабатическом характере процесса и работе, совершаемой только за счет изменения объема, получаем:
\begin{equation}
\label{eq:ch2/energy_balance_1}
    dU = -pdV + hdm.
\end{equation}

Для идеального газа внутренняя энергия определяется как $U = mC_vT$. Дифференцируя это выражение и приравнивая к уравнению \eqref{eq:ch2/energy_balance_1}, получаем:
\begin{equation}
\label{eq:ch2/energy_balance_2}
    C_vTdm + mC_vdT = -pdV + hdm.
\end{equation}

Используя определение энтальпии для идеального газа $h = C_pT$ и соотношение $C_p - C_v = R$, преобразуем уравнение \eqref{eq:ch2/energy_balance_2}:
\begin{equation}
\label{eq:ch2/energy_balance_3}
    mC_vdT = -pdV + RTdm.
\end{equation}

Разделив обе части уравнения \eqref{eq:ch2/energy_balance_3} на $dt$ и учитывая, что $dm/dt$ представляет собой массовый расход $G$, получаем дифференциальное уравнение:
\begin{equation}
\label{eq:ch2/energy_balance_4}
    mC_v\frac{dT}{dt} = -p\frac{dV}{dt} + RTG.
\end{equation}

Далее воспользуемся уравнением состояния идеального газа \eqref{eq:ch2/ideal_gas_equation}. Дифференцируя его по времени и комбинируя с уравнением \eqref{eq:ch2/energy_balance_4}, после алгебраических преобразований приходим к выражению:
\begin{equation}
\label{eq:ch2/energy_balance_5}
    \frac{dT}{dt} = \frac{T}{p}\frac{dp}{dt} + \frac{(\gamma-1)T}{V}\frac{dV}{dt},
\end{equation}
где $\gamma = C_p/C_v$ - показатель адиабаты, определенный ранее.

Учитывая конфигурацию распределителей, описанную в системе уравнений \eqref{eq:ch2/pressure_system}, запишем уравнения изменения температур для обеих полостей пневмоцилиндра:
\begin{equation}
\label{eq:ch2/energy_balance_6}
    \begin{cases}
        \begin{aligned}
            \frac{dT_1}{dt} & = \frac{T_1}{p_1}\frac{dp_1}{dt} + \frac{(\gamma-1)T_1}{V_1}\frac{dV_1}{dt}, \\
            \frac{dT_2}{dt} & = \frac{T_2}{p_2}\frac{dp_2}{dt} + \frac{(\gamma-1)T_2}{V_2}\frac{dV_2}{dt}.
        \end{aligned}
    \end{cases}
\end{equation}

Подставляя выражения для $dp_1/dt$ и $dp_2/dt$ из системы \eqref{eq:ch2/final_pressure_system}, а также учитывая изменение объемов полостей,
связанное с движением поршня, как описано в уравнениях \eqref{eq:ch2/volume_change}, получаем окончательную
систему уравнений, описывающую изменение температур в полостях пневмоцилиндра:

\begin{equation}
\label{eq:ch2/energy_balance_final}
    \begin{cases}
        \begin{aligned}
            \frac{dT_1}{dt} & = \frac{\gamma-1}{m_1C_v}\left[RT_1(G_{1\text{вх}} - G_{1\text{вых}}) - p_1F_1\frac{dx}{dt}\right], \\
            \frac{dT_2}{dt} & = \frac{\gamma-1}{m_2C_v}\left[RT_2(G_{2\text{вх}} - G_{2\text{вых}}) + p_2F_2\frac{dx}{dt}\right].
        \end{aligned}
    \end{cases}
\end{equation}

Данная система уравнений \eqref{eq:ch2/energy_balance_final} полностью согласуется с ранее выведенными
уравнениями изменения давлений и описывает термодинамические процессы в пневмоприводе
с дискретными распределителями, учитывая массообмен через распределители и работу, совершаемую при движении поршня.

\section{Моделирование силы трения}\label{sec:ch2/sec2/subsec4}
В рамках математического моделирования электропневматического привода существенное значение имеет адекватное описание динамических эффектов трения,
оказывающих значительное влияние на точность позиционирования и качество переходных процессов.
Модель LuGre (Lund-Grenoble) представляет собой комплексный подход к моделированию трения,
основанный на представлении микроскопической природы контактного
взаимодействия поверхностей через концепцию щетиночной структуры.

Фундаментальное уравнение модели LuGre описывает эволюцию средней деформации
микронеровностей контактирующих поверхностей во времени и может быть представлено в виде дифференциального уравнения первого порядка:
\begin{equation}
\label{eq:ch2/lugre}
\frac{dz}{dt} = v - \frac{\sigma_0|v|}{g(v)}z,
\end{equation}
где $z$ -- средняя деформация микронеровностей;
$v$ -- относительная скорость скольжения;
$\sigma_0$ -- представляет собой коэффициент жесткости микроскопических деформаций.

Функция $g(v)$, известная как функция Штрибека, описывает характер установившегося трения и задается следующим выражением:

\begin{equation}
\label{eq:ch2/stiction_function}
g(v) = R_\text{к} + (R_\text{с} - R_\text{к})e^{-(|v|/v_s)^\delta},
\end{equation}
где $R_\text{к}$ -- сила кулоновского трения;
$R_\text{с}$ -- определяет силу статического трения;
$v_s$ -- характерная скорость Штрибека;
$\delta$ -- эмпирический параметр формы, для которого типичным значением считается $\delta = 2$.

Результирующая сила трения в модели LuGre формируется как суперпозиция трех составляющих:
\begin{equation}
\label{eq:ch2/friction_force}
R_\text{тр} = \sigma_0z + \sigma_1\dot{z} + \sigma_2v,
\end{equation}
где $\sigma_1$ -- демпфирование микродеформаций;
$\sigma_2$ -- коэффициент вязкого трения.

Параметры модели LuGre обладают четкой физической интерпретацией, что существенно облегчает процесс их идентификации. 
Коэффициент $\sigma_0$ характеризует жесткость контактного взаимодействия микронеровностей и 
определяется как предел отношения приращения силы трения к приращению деформации при стремлении последней к нулю:
\begin{equation}
\label{eq:ch2/stiffness}    
\sigma_0 = \lim_{z \to 0} \frac{\partial R_\text{тр}}{\partial z},
\end{equation}

Параметр микродемпфирования $\sigma_1$ связан с коэффициентом жесткости через коэффициент микродемпфирования $\eta$:
\begin{equation}
\sigma_1 = \eta\sigma_0.
\end{equation}

Коэффициент вязкого трения $\sigma_2$ определяет асимптотическое поведение силы трения при больших скоростях движения:
\begin{equation}
\lim_{v \to \infty} \frac{R_\text{тр}}{v} = \sigma_2.
\end{equation}

В контексте электропневматического привода модель LuGre позволяет учесть ряд важных эффектов.
При малых перемещениях поршня наблюдается эффект предварительного смещения (эффект Дала), описываемый
соотношением $R_\text{пред} = \sigma_0z$ при условии $|z| < z_\text{макс}$. В области малых скоростей проявляется
нелинейная зависимость силы трения от скорости: $R_\text{нел}(v) = g(v)\text{sign}(v) + \sigma_2v$. При
реверсивном движении наблюдается гистерезисное поведение с характерной величиной $\Delta R_\text{гист} = 2R_\text{с}$ при $v = 0$.

Применение модели LuGre в математическом описании электропневматического привода обеспечивает существенное
повышение точности моделирования динамических процессов, особенно в режимах малых перемещений и при
реверсивном движении, что имеет критическое значение для решения задач прецизионного позиционирования.
Учет динамических эффектов трения позволяет более точно прогнозировать поведение системы и разрабатывать
эффективные алгоритмы управления с учетом реальных физических процессов в зоне контакта движущихся элементов привода.

\section{Моделирование силы реакции опоры}\label{sec:ch2/sec2/subsec5}

В контексте математического моделирования электропневматического привода существенную роль играет
адекватное описание силы реакции опоры. Данная сила возникает при контакте поршня пневмоцилиндра
с ограничителями хода и оказывает значительное влияние на динамику системы, особенно в крайних положениях.

Сила реакции опоры $R_\text{упор}$ может быть представлена как функция положения поршня $x$ и его скорости $\dot{x}$:
\begin{equation}
    R_\text{упор} = f(x, \dot{x}).
\end{equation}

При этом необходимо учитывать, что данная сила проявляется только при достижении
поршнем крайних положений. Таким образом, модель силы реакции опоры должна включать
условия её активации.

Наиболее распространенным подходом к моделированию силы реакции опоры является использование кусочно-линейной модели с учетом жесткости и демпфирования. Данная модель может быть описана следующим образом:
\begin{equation}
\label{eq:ch2/support_reaction}
    R_\text{оп} = \begin{cases}
        k_\text{оп}(x - x_\text{мин}) + b_\text{оп}\dot{x},  & \text{если } x < x_\text{мин}                       \\
        0,                                                   & \text{если } x_\text{мин} \leq x \leq x_\text{макс} \\
        k_\text{оп}(x - x_\text{макс}) + b_\text{оп}\dot{x}, & \text{если } x > x_\text{макс}
    \end{cases}
\end{equation}